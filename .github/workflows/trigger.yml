name: trigger

on:
  push:
    branches: [ "new_workflow" ]
jobs:
 deploy: 
    runs-on: ubuntu-latest
    env:
      #SERVICE_NAME: starter-service
      DEPLOYMENT_NOTIFICATION_URL: https://api.github.com/repos/komal0094/terraform_code2/dispatches
      GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
    steps:
     - run: |
         AUTH_HEADER="Authorization: token ${{ secrets.GITHUB_TOKEN }}"
         PAYLOAD='{ "event_type": "deploy_service"}'
         curl --request POST "$DEPLOYMENT_NOTIFICATION_URL" --header "$AUTH_HEADER" --header "Content-Type: application/json" --data-raw "$PAYLOAD" -f -i

        